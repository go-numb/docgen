## ドキュメント生成 docgen

このリポジトリは、指定されたディレクトリ内 のファイル群を分析し、その内容に基づいてドキュメントを生成するツールです。 this name comes from the [document generator].

### ファイル構成

- **Cargo.toml**: プロジェクトの依存関係とメタデータを定義するファイルです。
  - `walkdir`: 再帰的なディレクトリ走査のためのライブラリ。
  - `ignore`: `.gitignore` に従って無視すべきファイルを指定するためのライブラリ。
  - `reqwest`: GEMINI API との HTTP リクエストを行うためのライブラリ。
  - `tokio`: 非同期処理のためのライブラリ。
  - `clap`: コマンドライン引数の解析を行うためのライブラリ。
  - `serde_json`: JSON 形式のデータのシリアライズとデシリアライズを行うためのライブラリ。
  - `serde`: シリアライズとデシリアライズの汎用ライブラリ。
- **src/main.rs**: プログラムのエン トリポイントです。
  - コマンドライン引数を解析します。
  - 指定されたディレクトリ内のファイル群をスキャンします。
  - ファイルの内容を GEMINI API に送信します。
  - GEMINI API の応答を処理します。
- **src/req/gemini.rs**: GEMINI API との通信を扱うモジュールです。
  - `request`: GEMINI API にリクエストを送信する関数。
  - `get_content_for_gemini`: GEMINI API の応答からテキストコンテンツを抽出する関数。
- **src/req/mod.rs**: `gemini` モジュールをエクスポートするモジュールです。

### ファイル内容

#### src/main.rs

- `main` 関数:
  - コマンドライン引数を `clap` ライブラリを使用して解析します。
  - `scan_for_files` 関数を呼び出して、指定されたディレクトリ内のフ ァイル群をスキャンします。
  - スキャンされたファイルの内容を GEMINI API に送信する 準備をします。
  - ユーザーにファイルの送信を許可するかどうかを問い合わせます。
  - `request` 関数を呼び出して GEMINI API にリクエストを送信します。
  - GEMINI API の 応答を処理します。
- `scan_for_files`: 指定されたディレクトリ内のファイル群を走査し、ファイルの内容を文字列として返します。
  - `WalkBuilder` を使用して、ディレクトリを再帰的に走査します。
  - `is_document_or_source_code` 関数を使用して、処理対象のファイ ルかどうかを判定します。
  - ファイルの内容を文字列として読み込みます。
- `is_document_or_source_code`: 指定されたファイルが、処理対象となるドキュメントまたはソースコードかどうかを判定する関数。
  - ファイルの拡張子に基づいて判定します。
- `default_prompt`: GEMINI API に送信するプロンプトを生成する関数。
  - ユーザーが独自のプロンプトを指定していない場合は、デフォルトのプロンプトを生成します。

#### src/req/gemini.rs

- `request`: GEMINI API にリクエストを送信する関数。
  - `reqwest` ライブラリを使 用して、HTTP POST リクエストを送信します。
  - リクエストヘッダーに `content-type` を設定します。
  - リクエストボディに JSON 形式のデータを設定します。
- `get_content_for_gemini`: GEMINI API の応答からテキストコンテンツを抽出する関数。
  - `serde_json` ライブラリを使用して、JSON 形式のデータからテキストコンテンツを抽出します。

### プロジェクトの目的

このツールは、指定されたディレクトリ内のファイル群を分析し、その内容に基づいてドキュメントを生成することを目的としています。
特に、ファイル構成、ファイルの主要な機能、重要な関数やクラスの説明、ファイル間の依存関係、プロジェクト全体の目的と使用方法に関するドキュメントを生成します。

### 使用方法

1. プロジェクトをビル ドします。
2. コマンドラインで以下のコマンドを実行します。
```
cargo run -- [ディレクトリ名] --model [モデル名] --prompt [プロンプト]
```
- `[ディレクトリ名]`: 分析対 象のディレクトリの名前。デフォルト値は`.` (現在のディレクトリ) です。
- `[モデル名]`: 使用する GEMINI モデルの名前。デフォルト値は `gemini-1.5-flash` です。
- `[プロンプト]`: GEMINI API に送信するプロンプト。デフォルトのプロンプトは、ファイル構成、ファイルの主要な機能、重要な関数やクラスの説明、ファイル間の依存関係、プロジェクト全体の目的と使用方法に関するドキュメントを生成するように設定されています。

### その他

- このツールは、GEMINI API を使用するため、API キーが必要です。API キーは `GOOGLE_GEMINI_API_KEY` 環境変数に設定する必要があります。
- ファイルの送信前に、ユーザーに送信の許 可を問い合わせます。
- GEMINI API の応答は、JSON 形式で返されます。

### 改良点

- 複数のファイルの処理に時間がかかる場合があるため、パフォーマンスの改善が必要。
- GEMINI API の使用に制限があるため、無料版では利用回数に制限がある。
- コードのドキュ メント化、特に関数やクラスの説明を追加することが重要。
- ファイルのフィルタリング機能を追加して、特定の種類のファイルのみを処理できるようにする。
- 複数の言語に対応できるようにする。